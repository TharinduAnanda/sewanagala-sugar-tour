[phases.setup]
nixPkgs = ["nodejs_20", "npm-9_x"]

[phases.install]
cmds = ["npm install --legacy-peer-deps"]

[phases.build]
cmds = [
  "npm run build 2>&1 | tee build.log || true",
  "if [ ! -f .next/prerender-manifest.json ]; then echo 'Creating minimal prerender-manifest...'; echo '{\"version\":4,\"routes\":{},\"dynamicRoutes\":{},\"preview\":{\"previewModeId\":\"\",\"previewModeSigningKey\":\"\",\"previewModeEncryptionKey\":\"\"}}' > .next/prerender-manifest.json; fi",
  "if [ -f .next/BUILD_ID ]; then echo '✓ Build ready'; exit 0; else echo '✗ Build failed'; exit 1; fi"
]

[start]
cmd = "npm start"

# Create valid JSON manifest structure
