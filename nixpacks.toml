[phases.setup]
nixPkgs = ["nodejs_20", "npm-9_x"]

[phases.install]
cmds = ["npm install --legacy-peer-deps"]

[phases.build]
cmds = [
  "npm run build || true",
  "if [ -f .next/BUILD_ID ]; then echo 'Build artifacts created, continuing...'; exit 0; else echo 'Build failed completely'; exit 1; fi"
]

[start]
cmd = "npm start"

# Check for BUILD_ID instead of prerender-manifest
